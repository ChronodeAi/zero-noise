(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1067:(e,t,a)=>{Promise.resolve().then(a.bind(a,1808))},1808:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var r=a(5155),l=a(2115),i=a(4054);let s=["application/pdf","image/png","image/jpeg","image/jpg","image/gif","image/webp","video/mp4","text/plain","text/csv","application/vnd.ms-excel"],n={"application/pdf":[[37,80,68,70]],"image/png":[[137,80,78,71,13,10,26,10]],"image/jpeg":[[255,216,255,224],[255,216,255,225],[255,216,255,226]],"image/gif":[[71,73,70,56,55,97],[71,73,70,56,57,97]],"video/mp4":[[0,0,0,24,102,116,121,112],[0,0,0,28,102,116,121,112]]};async function o(e,t){return new Promise((a,r)=>{let l=new FileReader,i=e.slice(0,t);l.onload=()=>{a(Array.from(new Uint8Array(l.result)))},l.onerror=()=>r(Error("Failed to read file header")),l.readAsArrayBuffer(i)})}async function c(e){if("text/plain"===e.type||"text/csv"===e.type||"application/vnd.ms-excel"===e.type)return{valid:!0};let t=n[e.type];if(!t)return{valid:!0};try{let a=await o(e,16);if(!t.some(e=>!(a.length<e.length)&&e.every((e,t)=>a[t]===e)))return{valid:!1,error:'File "'.concat(e.name,"\" appears to be corrupted or has incorrect extension. The file content doesn't match the declared type.")};return{valid:!0}}catch(t){return{valid:!1,error:'Failed to validate file "'.concat(e.name,'": ').concat(t instanceof Error?t.message:"Unknown error")}}}async function d(e){let t=s.includes(e.type)?{valid:!0}:{valid:!1,error:'File type "'.concat(e.type,'" is not allowed. Supported types: PDF, Images, Videos, Text, CSV')};if(!t.valid)return t;let a=e.size>0x6400000?{valid:!1,error:'File "'.concat(e.name,'" is too large (').concat((e.size/1024/1024).toFixed(2),"MB). Maximum size is ").concat(100,"MB")}:0===e.size?{valid:!1,error:'File "'.concat(e.name,'" is empty')}:{valid:!0};if(!a.valid)return a;let r=await c(e);return r.valid?{valid:!0}:r}async function m(e){return await Promise.all(e.map(async e=>({file:e,result:await d(e)})))}function x(e){let{onFilesSelected:t,maxFileSize:a=0x6400000,allowedTypes:s=["application/pdf","image/png","image/jpeg","image/jpg","image/gif","video/mp4","text/plain","text/csv","application/vnd.ms-excel"]}=e,[n,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),x=(0,l.useCallback)(async(e,r)=>{if(d(null),r.length>0)return void d(r.map(e=>{var t;let r=null==(t=e.errors[0])?void 0:t.code;return"file-too-large"===r?"".concat(e.file.name,": File too large (max ").concat(a/1024/1024,"MB)"):"file-invalid-type"===r?"".concat(e.file.name,": Invalid file type"):"".concat(e.file.name,": Upload failed")}).join(", "));if(0===e.length)return void d("No files selected");o(!0);try{let a=(await m(e)).filter(e=>!e.result.valid);if(a.length>0){let e=a.map(e=>"".concat(e.file.name,": ").concat(e.result.error));d(e.join(" • ")),o(!1);return}await t(e)}catch(e){d(e instanceof Error?e.message:"Upload failed")}finally{o(!1)}},[t,a]),{getRootProps:p,getInputProps:h,isDragActive:u}=(0,i.VB)({onDrop:x,accept:s.reduce((e,t)=>(e[t]=[],e),{}),maxSize:a,multiple:!0});return(0,r.jsxs)("div",{className:"w-full max-w-2xl mx-auto",children:[(0,r.jsxs)("div",{...p(),className:"\n          border-2 border-dashed rounded-lg p-12 text-center cursor-pointer\n          transition-colors duration-200\n          ".concat(u?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400","\n          ").concat(n?"opacity-50 cursor-not-allowed":"","\n        "),children:[(0,r.jsx)("input",{...h(),disabled:n}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"mx-auto w-16 h-16 text-gray-400",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})})}),n?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg font-medium text-gray-700",children:"Uploading..."}),(0,r.jsx)("div",{className:"mt-2 w-full max-w-xs mx-auto h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-blue-500 animate-pulse",style:{width:"100%"}})})]}):u?(0,r.jsx)("p",{className:"text-lg font-medium text-blue-600",children:"Drop files here"}):(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg font-medium text-gray-700",children:"Drag & drop files here"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"or click to select files"})]}),!n&&(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["Supported: PDF, Images, Videos, Text, CSV • Max ",a/1024/1024,"MB per file"]})]})]}),c&&(0,r.jsx)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:c})})]})}function p(){let[e,t]=(0,l.useState)([]),[a,i]=(0,l.useState)(null),[s,n]=(0,l.useState)(!1),o=async e=>{let a=new FormData;e.forEach(e=>a.append("file",e));let r=await fetch("/api/upload",{method:"POST",body:a}),l=await r.json();if(!r.ok)throw Error(l.error||"Upload failed");let s=l.results.filter(e=>e.success).map(e=>({name:e.filename,size:e.size,cid:e.cid,gatewayUrl:e.gatewayUrl}));t(e=>[...e,...s]),l.collectionId&&i(l.collectionId)},c=async()=>{if(!a)return;let e="".concat(window.location.origin,"/c/").concat(a);try{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return(0,r.jsx)("main",{className:"min-h-screen p-8 md:p-24",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)("h1",{className:"text-6xl font-bold mb-4",children:"Zero Noise"}),(0,r.jsx)("p",{className:"text-xl text-gray-600 mb-2",children:"Decentralized P2P file sharing on IPFS"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Sprint 1: Upload Component ✅"})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)(x,{onFilesSelected:o})}),a&&(0,r.jsxs)("div",{className:"mb-8 bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"\uD83D\uDCE6 Shareable Collection URL"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"text",readOnly:!0,value:"".concat(window.location.origin,"/c/").concat(a),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm"}),(0,r.jsx)("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 whitespace-nowrap",children:s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})}),"Copied!"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})}),"Copy URL"]})})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-3",children:"Share this URL with anyone to let them view and download your uploaded files"})]}),e.length>0&&(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Uploaded Files"}),(0,r.jsx)("div",{className:"space-y-2",children:e.map((e,t)=>(0,r.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-medium",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[(e.size/1024/1024).toFixed(2)," MB"]}),e.cid&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("p",{className:"text-xs text-gray-400 font-mono",children:["CID: ",e.cid.substring(0,20),"..."]}),e.gatewayUrl&&(0,r.jsx)("a",{href:e.gatewayUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"View on IPFS Gateway →"})]})]}),(0,r.jsx)("div",{className:"text-green-600 flex-shrink-0",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})})})]},t))})]})]})})}}},e=>{e.O(0,[54,441,255,358],()=>e(e.s=1067)),_N_E=e.O()}]);